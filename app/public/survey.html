<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Friend Finder: Survey</title>
    <link rel="stylesheet" href="css/reset.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/style.css">

</head>

<body>
    <div class="container">
        <div class="row">
            <h1>Friend Finder Survey</h1>
            <hr>
            <a href="/">
                <button type="button" class="btn btn-info btn-md center-block" id="home">
                    <span class="glyphicon glyphicon-home"></span> Head Back Home</button>
            </a>
        </div>
        <div class="row">
            <h4>First, provide your name and a link to an image of you</h4>
            <form>
                <div class="form-group">
                    <label for="name">Name</label>
                    <input type="name" class="form-control" id="name" placeholder="Jane Doe">
                </div>
                <div class="form-group">
                    <label for="image">Profile Picture</label>
                    <input type="link" class="form-control" id="profilePicture" placeholder="https://cdn.vectorstock.com/i/thumb-large/52/66/14065266.jpg">
                </div>
            </form>
            <hr>
        </div>
        <div class="row">
            <h4>Then, on a scale of 1 (strongly disagree) to 5 (strongly agree), please indicate your level of agreement with
                the following statements</h4>
            <br>
            <label for="question1">1. I have a vivid imagination</label>
            <select class="form-control" id="q1">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question2">2. I like to solve complex problems</label>
            <select class="form-control" id="q2">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question3">3. I dislike being the center of attention</label>
            <select class="form-control" id="q3">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question4">4. I try to follow the rules</label>
            <select class="form-control" id="q4">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question5">5. I am always on the go</label>
            <select class="form-control" id="q5">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question6">6. I believe that there is no absolute right and wrong</label>
            <select class="form-control" id="q6">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question7">7. I feel sympathy for those who are worse off than myself</label>
            <select class="form-control" id="q7">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question8">8. I am always prepared</label>
            <select class="form-control" id="q8">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question9">9. I value cooperation over competition</label>
            <select class="form-control" id="q9">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <label for="question10">10. I stick to my chosen path</label>
            <select class="form-control" id="q10">
                <option value="0"></option>
                <option value="1">1 (strongly disagree)</option>
                <option value="2">2 (disagree) </option>
                <option value="3">3 (neither agree nor disagree)</option>
                <option value="4">4 (agree)</option>
                <option value="5">5 (strongly agree)</option>
            </select>
            <br>
            <button type="submit" class="btn btn-info btn-md" id="confirm">SUBMIT</button>
        </div>

        <!-- Modal Dialog Displaying Closest Friend Match -->
        <div id="friendModal" class="modal">
            <div class="modal-content">
                <h4>Closest Friend Match</h4>
                <div class="divider"></div>
                <h5 id="matchName"></h5>
                <img id="matchImg" class="materialboxed" width="650" src="">
            </div>
            <div class="modal-footer">
                <a href="/survey" class="modal-action modal-close btn-info">Fill Again!</a>
            </div>
        </div>
    </div>

    <div class="modal fade">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <h5 class="modal-title">Closest Friend Match</h5>
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                  </button>
                </div>
                <div class="modal-body">
                        <h5 id="matchName"></h5>
                        <img id="matchImg" class="materialboxed" width="650" src="">
                </div>
                <div class="modal-footer">
                        <a href="/survey">
                  <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                  </a>
                </div>
              </div>
            </div>
          </div>
    <script type="text/javascript">
        // Activate submit button
        $("#confirm").on("click", function () {
            // Form validation
            function validateForm() {
                var isValid = true;
                $('.form-control').each(function () {
                    if ($(this).val() === '')
                        isValid = false;
                });
                $('.chosen-select').each(function () {
                    if ($(this).val() === "")
                        isValid = false
                })
                return isValid;
            }
            // If all required fields are filled
            if (validateForm() == true) {
                // Create an object for the user's data
                var userData = {
                    name: $("#name").val(),
                    photo: $("#profilePicture").val(),
                    scores: [$("#q1").val(), $("#q2").val(), $("#q3").val(), $("#q4").val(), $("#q5").val(), $("#q6").val(), $("#q7").val(), $("#q8").val(), $("#q9").val(), $("#q10").val(),]
                }
                // Grab the URL of the website
                var currentURL = window.location.origin;
                // AJAX post the data to the friends API. 
                $.post(currentURL + "/api/friends", userData, function (data) {
                    // Grab the result from the AJAX post so that the best match's name and photo are displayed.
                    $("#matchName").text(data.name);
                    $('#matchImg').attr("src", data.photo);
                    // Show the modal with the best match 
                    $("#friendModal").modal('toggle');
                });
            } else {
                alert("Please fill out all fields before submitting!");
            }
            return false;
        });
    </script>
</body>

</html>